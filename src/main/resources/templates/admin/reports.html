<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
	<meta charset="UTF-8">
	<title>Reports | Admin Dashboard</title>
	<link rel="stylesheet" th:href="@{/css/styles.css}">
	<style>
		body {
			font-family: 'Inter', sans-serif;
			background: var(--light-gradient);
			margin: 0;
			padding: 0;
			color: #111827;
		}

		.container {
			max-width: 1100px;
			margin: 3rem auto;
			padding: 2rem;
		}

		h2 {
			text-align: center;
			font-size: 2.2rem;
			background:  black;
			-webkit-background-clip: text;
			-webkit-text-fill-color: transparent;
			font-weight: 700;
			margin-bottom: 2.5rem;
			letter-spacing: 0.5px;
		}

		form {
			display: flex;
			flex-wrap: wrap;
			justify-content: center;
			gap: 1.5rem;
			margin-bottom: 2rem;
			background: white;
			padding: 1.5rem 2rem;
			border-radius: 1rem;
			box-shadow: 0 10px 25px -5px rgba(0,0,0,0.1);
		}

		label {
			font-weight: 600;
			color: #1f2937;
			display: block;
			margin-bottom: 0.5rem;
		}

		select {
			padding: 0.75rem 1rem;
			border-radius: 0.5rem;
			border: 2px solid #e2e8f0;
			font-size: 1rem;
			width: 220px;
			outline: none;
			transition: all 0.3s ease;
		}

		select:focus {
			border-color: #6366f1;
			box-shadow: 0 0 0 3px rgba(99,102,241,0.2);
		}

		button {
			padding: 0.75rem 1.5rem;
			border-radius: 0.75rem;
			cursor: pointer;
			font-size: 1rem;
		}

		.btn-submit {
			background: linear-gradient(135deg, #4F46E5 0%, #7C3AED 50%, #EC4899 100%);
			border: none;
			transition: all 0.3s ease;
		}
		

		.btn-submit:hover {
			transform: translateY(-3px);
			box-shadow: 0 8px 20px rgba(99,102,241,0.3);
			
		}

		.card {
			padding: 1.5rem;
			margin: 1.5rem 0;
			border-radius: 1rem;
			background: white;
			box-shadow: 0 4px 10px rgba(0,0,0,0.1);
			animation: fadeInUp 0.5s ease-out;
		}

		.card h5 {
			margin: 0;
			font-size: 1.2rem;
			font-weight: 600;
			color: #111827;
		}

		table {
			width: 100%;
			border-collapse: collapse;
			margin-top: 1rem;
		}

		th, td {
			padding: 0.75rem 1rem;
			border-bottom: 1px solid #e5e7eb;
			text-align: left;
		}

		th {
			background: #f9fafb;
			font-weight: 600;
			color: #374151;
		}

		tr:hover {
			background: #f3f4f6;
		}

		.text-center {
			text-align: center;
		}

		.text-muted {
			color: #9ca3af;
		}

		.alert {
			padding: 1rem 1.5rem;
			border-radius: 10px;
			font-weight: 500;
			margin-bottom: 1rem;
			text-align: center;
		}

		.alert-danger {
			background: var(--danger-gradient);
			color: white;
		}

		.fade-in {
			animation: fadeInUp 0.6s ease;
		}

		@keyframes fadeInUp {
			from { opacity: 0; transform: translateY(15px); }
			to { opacity: 1; transform: translateY(0); }
		}
	</style>
</head>

<body>
	<div class="container">
		<h2>Reports Dashboard</h2>

		<!-- Filter Form -->
		<form th:action="@{/admin/reports}" method="get" class="fade-in">
			<div>
				<label>Report Type</label>
				<select name="type" required>
					<option value="">Select Type</option>
					<option value="events" th:selected="${selectedType == 'events'}">Events</option>
					<option value="registrations" th:selected="${selectedType == 'registrations'}">Registrations</option>
					<option value="users" th:selected="${selectedType == 'users'}">Users</option>
				</select>
			</div>

			<div>
				<label>Period</label>
				<select name="period">
					<option value="">All Time</option>
					<option value="week" th:selected="${selectedPeriod == 'week'}">Past Week</option>
					<option value="month" th:selected="${selectedPeriod == 'month'}">Past Month</option>
					<option value="year" th:selected="${selectedPeriod == 'year'}">Past Year</option>
				</select>
			</div>

			<div style="align-self: flex-end;">
				<button type="submit" class="btn btn-submit">Generate</button>
			</div>
		</form>

		<!-- Reports Display -->
		<div th:if="${reportData != null}" class="fade-in">

			<!-- Error Message -->
			<div th:if="${reportData?.get('error') != null}" class="alert alert-danger">
				<span th:text="${reportData?.get('error')}"></span>
			</div>

			<!-- EVENTS REPORT -->
			<div th:if="${selectedType == 'events'}">
				<div class="card gradient-border">
					<h5>Total Events: <span style="color:#4F46E5;" th:text="${reportData.totalEvents}">0</span></h5>
				</div>

				<div class="card gradient-border">
					<h5>Events by Department</h5>
					<table>
						<thead>
							<tr>
								<th>Department</th>
								<th>Event Count</th>
							</tr>
						</thead>
						<tbody>
							<tr th:each="entry : ${reportData.eventsByDepartment}">
								<td th:text="${entry.key}"></td>
								<td th:text="${entry.value}"></td>
							</tr>
							<tr th:if="${#lists.isEmpty(reportData.eventsByDepartment)}">
								<td colspan="2" class="text-center text-muted">No data available</td>
							</tr>
						</tbody>
					</table>
				</div>
			</div>

			<!-- REGISTRATIONS REPORT -->
			<div th:if="${selectedType == 'registrations'}">
				<div class="card gradient-border">
					<h5>Total Registrations: <span style="color:#4F46E5;" th:text="${reportData.totalRegistrations}">0</span></h5>
				</div>

				<div class="card gradient-border">
					<h5>Registrations by Status</h5>
					<table>
						<thead>
							<tr>
								<th>Status</th>
								<th>Count</th>
							</tr>
						</thead>
						<tbody>
							<tr th:each="entry : ${reportData.registrationsByStatus}">
								<td th:text="${entry.key}"></td>
								<td th:text="${entry.value}"></td>
							</tr>
							<tr th:if="${#lists.isEmpty(reportData.registrationsByStatus)}">
								<td colspan="2" class="text-center text-muted">No data available</td>
							</tr>
						</tbody>
					</table>
				</div>
			</div>

			<!-- USERS REPORT -->
			<div th:if="${selectedType == 'users'}">
				<div class="card gradient-border">
					<h5>Total Users: <span style="color:#4F46E5;" th:text="${reportData.totalUsers}">0</span></h5>
				</div>

				<div class="card gradient-border">
					<h5>Users by Role</h5>
					<table>
						<thead>
							<tr>
								<th>Role</th>
								<th>User Count</th>
							</tr>
						</thead>
						<tbody>
							<tr th:each="entry : ${reportData.usersByRole}">
								<td th:text="${entry.key}"></td>
								<td th:text="${entry.value}"></td>
							</tr>
							<tr th:if="${#lists.isEmpty(reportData.usersByRole)}">
								<td colspan="2" class="text-center text-muted">No data available</td>
							</tr>
						</tbody>
					</table>
				</div>
			</div>

		</div>

		<!-- Default Message -->
		<div th:if="${reportData == null}" class="text-center text-muted" style="margin-top: 3rem;">
			<p>Select a report type and period to generate the report.</p>
		</div>

	</div>
</body>
</html>
